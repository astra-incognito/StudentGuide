{% extends "base.html" %}

{% block title %}Settings - Student Hub{% endblock %}

{% block content %}
<div class="container">
    <!-- Page Header -->
    <div class="row mb-4">
        <div class="col-12">
            <h2><i class="fas fa-cog"></i> Application Settings</h2>
            <p class="text-muted">Customize your Student Hub experience</p>
        </div>
    </div>

    <!-- Settings Sections -->
    <div class="row">
        <!-- General Settings -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-user"></i> General Settings</h5>
                </div>
                <div class="card-body">
                    <form method="POST" action="{{ url_for('settings') }}">
                        <div class="mb-3">
                            <label for="studentName" class="form-label">Student Name</label>
                            <input type="text" class="form-control" id="studentName" name="studentName" value="{{ settings.student_name or '' }}" placeholder="Enter your name">
                        </div>
                        <div class="mb-3">
                            <label for="university" class="form-label">University/School</label>
                            <input type="text" class="form-control" id="university" name="university" value="{{ settings.university or '' }}" placeholder="Enter your institution">
                        </div>
                        <div class="mb-3">
                            <label for="major" class="form-label">Major/Field of Study</label>
                            <input type="text" class="form-control" id="major" name="major" value="{{ settings.major or '' }}" placeholder="Enter your major">
                        </div>
                        <div class="mb-3">
                            <label for="gradYear" class="form-label">Expected Graduation Year</label>
                            <input type="number" class="form-control" id="gradYear" name="gradYear" value="{{ settings.grad_year or '' }}" placeholder="2025" min="2024" max="2030">
                        </div>
                        <button type="submit" class="btn btn-primary">Save General Settings</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Notification Settings -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-bell"></i> Notification Settings</h5>
                </div>
                <div class="card-body">
                    <form method="POST" action="{{ url_for('settings') }}">
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="taskReminders" name="taskReminders" {% if settings.task_reminders %}checked{% endif %}>
                                <label class="form-check-label" for="taskReminders">
                                    Task Due Date Reminders
                                </label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="habitReminders" name="habitReminders" {% if settings.habit_reminders %}checked{% endif %}>
                                <label class="form-check-label" for="habitReminders">
                                    Daily Habit Reminders
                                </label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="devotionReminders" name="devotionReminders" {% if settings.devotion_reminders %}checked{% endif %}>
                                <label class="form-check-label" for="devotionReminders">
                                    Devotion Time Reminders
                                </label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="calendarNotifications" name="calendarNotifications" {% if settings.calendar_notifications %}checked{% endif %}>
                                <label class="form-check-label" for="calendarNotifications">
                                    Calendar Event Notifications
                                </label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="reminderTime" class="form-label">Default Reminder Time</label>
                            <select class="form-select" id="reminderTime" name="reminderTime">
                                <option value="5" {% if settings.reminder_time == '5' %}selected{% endif %}>5 minutes before</option>
                                <option value="15" {% if settings.reminder_time == '15' %}selected{% endif %}>15 minutes before</option>
                                <option value="30" {% if settings.reminder_time == '30' %}selected{% endif %}>30 minutes before</option>
                                <option value="60" {% if settings.reminder_time == '60' %}selected{% endif %}>1 hour before</option>
                                <option value="1440" {% if settings.reminder_time == '1440' %}selected{% endif %}>1 day before</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Save Notification Settings</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Theme & Display -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-palette"></i> Theme & Display</h5>
                </div>
                <div class="card-body">
                    <form method="POST" action="{{ url_for('settings') }}">
                        <div class="mb-3">
                            <label for="theme" class="form-label">Color Theme</label>
                            <select class="form-select" id="theme" name="theme">
                                <option value="dark" {% if settings.theme == 'dark' %}selected{% endif %}>Dark Theme</option>
                                <option value="light" {% if settings.theme == 'light' %}selected{% endif %}>Light Theme</option>
                                <option value="auto" {% if settings.theme == 'auto' %}selected{% endif %}>Auto (System)</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="accentColor" class="form-label">Accent Color</label>
                            <input type="color" class="form-control form-control-color" id="accentColor" name="accentColor" value="{{ settings.accent_color or '#0d6efd' }}" title="Choose accent color">
                        </div>
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="compactMode" name="compactMode" {% if settings.compact_mode %}checked{% endif %}>
                                <label class="form-check-label" for="compactMode">
                                    Compact Mode (Smaller spacing)
                                </label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="animations" name="animations" {% if settings.animations %}checked{% endif %}>
                                <label class="form-check-label" for="animations">
                                    Enable Animations
                                </label>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Save Display Settings</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Data & Privacy -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-shield-alt"></i> Data & Privacy</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <h6>Data Storage</h6>
                        <p class="text-muted small">Your data is stored locally in your browser and is not transmitted to external servers.</p>
                    </div>
                    <div class="mb-3">
                        <h6>Export Data</h6>
                        <p class="text-muted small">Download a backup of your data for safekeeping.</p>
                        <button type="button" class="btn btn-outline-primary" onclick="exportData()">
                            <i class="fas fa-download"></i> Export All Data
                        </button>
                    </div>
                    <div class="mb-3">
                        <h6>Clear Data</h6>
                        <p class="text-muted small">This will permanently delete all your data. This action cannot be undone.</p>
                        <button type="button" class="btn btn-outline-danger" onclick="clearData()">
                            <i class="fas fa-trash"></i> Clear All Data
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Academic Settings -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-graduation-cap"></i> Academic Settings</h5>
                </div>
                <div class="card-body">
                    <form method="POST" action="{{ url_for('settings') }}">
                        <div class="mb-3">
                            <label for="gpaScale" class="form-label">GPA Scale</label>
                            <select class="form-select" id="gpaScale" name="gpaScale">
                                <option value="4.0" {% if settings.gpa_scale == '4.0' %}selected{% endif %}>4.0 Scale</option>
                                <option value="5.0" {% if settings.gpa_scale == '5.0' %}selected{% endif %}>5.0 Scale</option>
                                <option value="10.0" {% if settings.gpa_scale == '10.0' %}selected{% endif %}>10.0 Scale</option>
                                <option value="100" {% if settings.gpa_scale == '100' %}selected{% endif %}>100 Point Scale</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="defaultTaskCategory" class="form-label">Default Task Category</label>
                            <select class="form-select" id="defaultTaskCategory" name="defaultTaskCategory">
                                <option value="general" {% if settings.default_task_category == 'general' %}selected{% endif %}>General</option>
                                <option value="assignment" {% if settings.default_task_category == 'assignment' %}selected{% endif %}>Assignment</option>
                                <option value="exam" {% if settings.default_task_category == 'exam' %}selected{% endif %}>Exam</option>
                                <option value="project" {% if settings.default_task_category == 'project' %}selected{% endif %}>Project</option>
                                <option value="reading" {% if settings.default_task_category == 'reading' %}selected{% endif %}>Reading</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="weekStart" class="form-label">Week Starts On</label>
                            <select class="form-select" id="weekStart" name="weekStart">
                                <option value="sunday" {% if settings.week_start == 'sunday' %}selected{% endif %}>Sunday</option>
                                <option value="monday" {% if settings.week_start == 'monday' %}selected{% endif %}>Monday</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="showGpa" name="showGpa" {% if settings.show_gpa %}checked{% endif %}>
                                <label class="form-check-label" for="showGpa">
                                    Show GPA Tracking (Future Feature)
                                </label>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Save Academic Settings</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- About & Help -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-info-circle"></i> About & Help</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <h6>Student Productivity Hub</h6>
                        <p class="text-muted">Version 1.0.0 - Free Edition</p>
                    </div>
                    <div class="mb-3">
                        <h6>Features</h6>
                        <ul class="list-unstyled text-muted small">
                            <li><i class="fas fa-check text-success"></i> Task & Assignment Management</li>
                            <li><i class="fas fa-check text-success"></i> Calendar & Scheduling</li>
                            <li><i class="fas fa-check text-success"></i> Course Management</li>
                            <li><i class="fas fa-check text-success"></i> Habit Tracking</li>
                            <li><i class="fas fa-check text-success"></i> Goal Setting</li>
                            <li><i class="fas fa-check text-success"></i> Financial Tracking</li>
                            <li><i class="fas fa-check text-success"></i> Devotion Journal</li>
                            <li><i class="fas fa-check text-success"></i> Project Management</li>
                        </ul>
                    </div>
                    <div class="mb-3">
                        <h6>Support</h6>
                        <p class="text-muted small">This is a free tool designed to help students succeed academically, spiritually, and personally.</p>
                    </div>
                    <div class="mb-3">
                        <h6>Keyboard Shortcuts</h6>
                        <div class="row text-muted small">
                            <div class="col-6">
                                <code>Ctrl + T</code> - New Task
                            </div>
                            <div class="col-6">
                                <code>Ctrl + E</code> - New Event
                            </div>
                            <div class="col-6">
                                <code>Ctrl + H</code> - Habits
                            </div>
                            <div class="col-6">
                                <code>Ctrl + G</code> - Goals
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Placeholder functions for data management
function exportData() {
    // This would typically make an API call to export data
    alert('Export functionality will be implemented to download your data as JSON/CSV files.');
}

function clearData() {
    if (confirm('Are you sure you want to delete ALL your data? This action cannot be undone.')) {
        if (confirm('This will delete all tasks, courses, habits, goals, financial entries, devotions, and projects. Type "DELETE" to confirm.')) {
            const confirmation = prompt('Type "DELETE" to confirm:');
            if (confirmation === 'DELETE') {
                // This would typically make an API call to clear all data
                alert('Data clearing functionality will be implemented to reset all user data.');
            }
        }
    }
}

// Save settings to localStorage (placeholder)
document.querySelectorAll('form').forEach(form => {
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Get form data
        const formData = new FormData(this);
        const settings = {};
        
        for (let [key, value] of formData.entries()) {
            settings[key] = value;
        }
        
        // Save to localStorage (in a real app, this would go to a backend)
        const settingsKey = 'studentHub_' + this.closest('.card').querySelector('h5').textContent.replace(/\s+/g, '');
        localStorage.setItem(settingsKey, JSON.stringify(settings));
        
        // Show success message
        const button = this.querySelector('button[type="submit"]');
        const originalText = button.textContent;
        button.textContent = 'Saved!';
        button.classList.remove('btn-primary');
        button.classList.add('btn-success');
        
        setTimeout(() => {
            button.textContent = originalText;
            button.classList.remove('btn-success');
            button.classList.add('btn-primary');
        }, 2000);
    });
});

// Load saved settings
window.addEventListener('load', function() {
    // This would load saved settings from localStorage or backend
    console.log('Settings page loaded - would restore saved preferences here');
});

// Keyboard shortcuts
document.addEventListener('keydown', function(e) {
    if (e.ctrlKey) {
        switch(e.key) {
            case 't':
                e.preventDefault();
                window.location.href = '/tasks';
                break;
            case 'e':
                e.preventDefault();
                window.location.href = '/calendar';
                break;
            case 'h':
                e.preventDefault();
                window.location.href = '/habits';
                break;
            case 'g':
                e.preventDefault();
                window.location.href = '/goals';
                break;
        }
    }
});
</script>
{% endblock %}
